# When in doubt, refer to <GranatumX_root>/gbox_installer/types/index.d.ts for the full schema.

# In GranatumX, many Gboxes with similar dependencies can share a single docker image to avoid unnecessary separation.
# This single docker image along with its specification (JSON or YAML) is called a "Gpackage".

# Here, the "id" is the ID of the Gpackage. It can be any string that can uniquely identify the Gpackage.
id: ExamplePackage

# This "meta" field in the root is for setting up the *default* metadata for all the Gboxes in this Gpackage. A lot of the time,
# all Gboxes in a Gpackage share the same maintainer (and maybe citations, etc.). Instead of repeating the same metadata under
# every Gbox, the DRY (don't-repeat-yourself) way of doing it is to put the default metadata here and omit these fields in each
# Gbox specification. The fields missing in each Gbox specification will be automatically filled with the default.
meta:
  maintainer:
    name: John Smith
    email: jsmith@gmail.com

# The "buildCommand" field is a shell command that is to run after the Gbox has been registered on the database (as part
# of the Gbox installation process). Usually it's a "make" command that builds the docker image.
buildCommand: 'make'

# The "gboxes" field contains a list of gboxes to be included in the Gpackage. Each item in the list can be either an
# in-line object that contains the Gbox specification or the path (a string) to a different YAML file that has the Gbox
# specification.
gboxes:

  - # This "id" is the ID of the Gbox. It can be any string that can uniquely identify the Gbox.
    id: ExampleGbox

    # This "meta" field is the meta field for the Gbox
    meta:
      title: Example Gbox
      subtitle: This Gbox serves as an example for the Gbox developers
      description: |
        This is a template package. You can use this package as a starting point for your own package.

        This string is intepreted as a Markdown string, so you can use any
        [Markdown](https://en.wikipedia.org/wiki/Markdown) *syntax* **as** ***expected***.

    # The "endpoints" are the backend hooks for GranatumX core to recognize. Currently only the "backend" endpoint is implemented.
    endpoints:
      # The "backend" field tells GranatumX how to execute a command, send in inputs, and get the ouptuts. Currently,
      # the "type: docker" is the only execution type recommended. The "image" and "cmd" field are assembled like this:
      # docker run <...params_injected_by_GranatumX...> <image> <cmd>
      backend:
        type: docker
        image: granatum/template
        cmd: python ./main.py

    # The "frontend" field defines the panels on the frontend. The "injectInto" field is the unique ID of the arg or
    # import. The difference between an "arg" and an "import" is: an "import" is something generated by a previous Gbox --
    # for example, an assay, or an annotation for genes or samples; an "arg" is a small piece of information gathered
    # from the user via the frontend panels.
    #
    # Again, refer to <GranatumX_root>/gbox_installer/types/index.d.ts for the exact schema.
    frontend:
      args:
        - injectInto: someCheckbox
          type: checkbox
          default: true
          label: A checkbox arg example
          description: This is the description for the checkbox arg.

        - injectInto: someNumber
          type: number
          default: 2000
          label: A number arg example
          description: This is the description for the number arg.

        - injectInto: someSeed
          type: seed
          default: 12345
          label: A random seed arg example
          description: This is the description for the random seed arg.

      imports:
        - kind: assay
          label: An assay import example
          injectInto: assay
